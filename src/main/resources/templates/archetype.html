<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<title th:text="|${archetypeName} - ${heroClass.name}|"></title>
</head>
<body>
	<div th:fragment="view" th:object="${heroClass}">
		<div th:replace="class :: classInfo"></div>
		<table>
			<thead>
				<tr align="center">
					<th rowspan="2" style="width: 24px">Ур.</th>
					<th rowspan="2" style="width: 24px">БМ</th>
					<th rowspan="2">Умения</th>
					<th th:each="featurelevelDefinition : *{featureLevelDefenitions}" align="center" rowspan="2" th:text="${featurelevelDefinition.name}" style="width: 5%">Умения класса</th>
					<th th:each="featurelevelDefinition : ${selectedArchetype.featureLevelDefenitions}" align="center" rowspan="2" th:text="${featurelevelDefinition.name}" style="width: 5%">Умения архетипа</th>
					<th th:unless="${heroClass.levelDefenitions.empty and selectedArchetype.levelDefenitions.empty}" align="center" colspan="9">Ячейки заклинаний на уровень заклинаний</th>
				</tr>
				<th:block th:unless="${heroClass.spellcasterType.name() eq 'NONE'}">
					<tr align="center">
						<th>1</th>
						<th>2</th>
						<th>3</th>
						<th>4</th>
						<th:block th:unless="${selectedArchetype.spellcasterType}">
							<th>5</th>
							<th:block th:unless="*{spellcasterType.name() eq 'HALF'}">
								<th>6</th>
								<th>7</th>
								<th>8</th>
								<th>9</th>
							</th:block>
						</th:block>
					</tr>
				</th:block>
				<th:block th:unless="${selectedArchetype.spellcasterType eq null}">
					<tr align="center">
						<th>1</th>
						<th>2</th>
						<th>3</th>
						<th>4</th>
					</tr>
				</th:block>
			</thead>
			<tbody th:with="levelDef=${ {0,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6} }">
				<tr th:each="level : ${#numbers.sequence(1, 20)}" align="center">
					<td align="center" th:text="${level}" />
					<td align="center" th:text="${'+' + levelDef[level]}" />
					<td><a class="text-info" th:each="architypeTrait, iterStat2 : ${heroClass.getArhitypeTraitNames(selectedArchetype.id, level)}"
						th:text="${iterStat2.last and heroClass.getTraitsClear(level).empty} ? ${#strings.toLowerCase(architypeTrait.name)} : ${#strings.toLowerCase(architypeTrait.name)} + ', '"
						th:href="|#a${architypeTrait.id}|" th:onclick="|slowScroll('#a${architypeTrait.id}')|" tabindex="0" data-bs-trigger="hover" data-bs-container="body" data-bs-toggle="popover"
						data-placement="auto" th:title="${architypeTrait.name}" th:attr="data-bs-content=${architypeTrait.description}"
					></a> <a th:each="trait, iterStat : ${heroClass.getTraits(level)}" class="text-primary" th:unless=${trait.architype} th:href="|#c${trait.id}|" th:onclick="|slowScroll('#c${trait.id}')|"
						th:utext="${iterStat.last} ? ${trait.name.toLowerCase()} : ${trait.name.toLowerCase()} + ', '" tabindex="0" data-bs-trigger="hover" data-bs-container="body" data-bs-toggle="popover"
						data-placement="auto" th:title="${trait.name}" th:attr="data-bs-content=${trait.description}"
					></a></td>
					<td th:each="featureLevel : *{featureLevelDefenitions}" th:with="byLevel = ${featureLevel.getByLevel(level)}"><th:block th:if="${featureLevel.prefix ne null and byLevel gt 0}"
							th:text="${featureLevel.prefix}"
						/> <th:block th:if="${byLevel gt 0}" th:text="${byLevel}" /> <th:block th:if="${byLevel eq 0}" th:text="'—'" /> <th:block th:if="${byLevel eq -1}" th:text="'Неограниченно'" /> <th:block
							th:if="${featureLevel.sufix ne null and byLevel gt 0}" th:text="${featureLevel.sufix}"
						/></td>
					<td th:each="featureLevel : ${selectedArchetype.featureLevelDefenitions}" th:with="byLevel = ${featureLevel.getByLevel(level)}"><th:block
							th:if="${featureLevel.prefix ne null and byLevel gt 0}" th:text="${featureLevel.prefix}"
						/> <th:block th:if="${byLevel gt 0}" th:text="${byLevel}" /> <th:block th:if="${byLevel eq 0}" th:text="'—'" /> <th:block th:if="${featureLevel.sufix ne null and byLevel gt 0}"
							th:text="${featureLevel.sufix}"
						/></td>
					<th:block th:unless="*{spellcasterType.name() eq 'NONE'}">
						<td th:text="${heroClass.levelDefenitions[level - 1].slot1 eq 0 ? '—' : heroClass.levelDefenitions[level - 1].slot1}" /></td>
						<td th:text="${heroClass.levelDefenitions[level - 1].slot2 eq 0 ? '—' : heroClass.levelDefenitions[level - 1].slot2}" />
						<td th:text="${heroClass.levelDefenitions[level - 1].slot3 eq 0 ? '—' : heroClass.levelDefenitions[level - 1].slot3}" />
						<td th:text="${heroClass.levelDefenitions[level - 1].slot4 eq 0 ? '—' : heroClass.levelDefenitions[level - 1].slot4}" />
						<td th:text="${heroClass.levelDefenitions[level - 1].slot5 eq 0 ? '—' : heroClass.levelDefenitions[level - 1].slot5}" />
						<th:block th:unless="*{spellcasterType.name() eq 'HALF'}">
							<td th:text="${heroClass.levelDefenitions[level - 1].slot6 eq 0 ? '—' : heroClass.levelDefenitions[level - 1].slot6}" />
							<td th:text="${heroClass.levelDefenitions[level - 1].slot7 eq 0 ? '—' : heroClass.levelDefenitions[level - 1].slot7}" />
							<td th:text="${heroClass.levelDefenitions[level - 1].slot8 eq 0 ? '—' : heroClass.levelDefenitions[level - 1].slot8}" />
							<td th:text="${heroClass.levelDefenitions[level - 1].slot9 eq 0 ? '—' : heroClass.levelDefenitions[level - 1].slot9}" />
						</th:block>
					</th:block>
					<th:block th:unless="${selectedArchetype.levelDefenitions.empty}">
						<td th:text="${selectedArchetype.levelDefenitions[level - 1].slot1 eq 0 ? '—' : selectedArchetype.levelDefenitions[level - 1].slot1}" /></td>
						<td th:text="${selectedArchetype.levelDefenitions[level - 1].slot2 eq 0 ? '—' : selectedArchetype.levelDefenitions[level - 1].slot2}" />
						<td th:text="${selectedArchetype.levelDefenitions[level - 1].slot3 eq 0 ? '—' : selectedArchetype.levelDefenitions[level - 1].slot3}" />
						<td th:text="${selectedArchetype.levelDefenitions[level - 1].slot4 eq 0 ? '—' : selectedArchetype.levelDefenitions[level - 1].slot4}" />
					</th:block>
				</tr>
			</tbody>
		</table>
		<th:block th:each="feature : ${features}">
			<h4 class="dote" th:text="${feature.name}" th:id="|${feature.prefix}${feature.id}|"></h4>
			<div class="caption_text" th:text="${feature.type}"></div>
			<p th:utext="${feature.description}" />
			<div th:if="${feature.prefix eq 'ad'}">
				<table class="table-striped mx-auto" th:unless=${archetypeSpells.empty}>
					<thead>
						<tr>
							<th th:unless="${heroClass.id eq 5}" class="text-center">Уровень<br>персонажа
							</th>
							<th th:if="${heroClass.id eq 5}" class="text-center">Уровень<br>заклинания
							</th>
							<th class="text-center">Заклинания</th>
						</tr>
					</thead>
					<tr th:each="element : ${selectedArchetype.levelSpells}">
						<td class="text-center" th:text="${element.key}"></td>
						<td><a class="text-danger" th:href="@{'/hero/spells/spell/' + ${spell.id}}" tabindex="0" data-bs-trigger="hover" data-bs-container="body" data-bs-toggle="popover" data-bs-placement="auto"
							th:title="${spell.name}" th:attr="data-bs-content=${spell.description}" th:each="spell, iterStat : ${element.value}"
							th:text="${iterStat.last} ? ${#strings.toLowerCase(spell.name)} : ${#strings.toLowerCase(spell.name)} + ', '"
						></a></td>
					</tr>
					<tbody>
					</tbody>
				</table>
			</div>
		</th:block>
	</div>
</body>
</html>